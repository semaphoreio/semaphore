# Semaphore v1.5 Manual Updates Required

This document lists all manual updates needed for the v1.5 documentation release, including screenshots, API documentation, and other manual changes.

---

## üî¥ HIGH PRIORITY: API Documentation Updates

### 1. Tasks API - Add Tag Support
**File**: `docs/reference/api.md` (Line ~597)
**Status**: CRITICAL - Feature is already deployed

#### Current Documentation:
```shell
curl -X POST --location "https://<organization-url>.semaphoreci.com/api/v1alpha/tasks/{task_id}/run_now" \
    -H "Authorization: Token {api_token}" \
    -H "Content-Type: application/json" \
    -d $'{
        "branch": "master",  # <-- NEEDS UPDATE
        "pipeline_file": "/.semaphore/deploy.yml",
        "parameters": {
            "PARAM_NAME": "PARAM_VALUE"
        }
    }'
```

#### Required Changes:
1. Replace `"branch"` parameter with `"reference"` parameter
2. Add documentation that `reference` accepts both branches and tags
3. Add examples showing tag usage:

```shell
# Example with tag
curl -X POST --location "https://<organization-url>.semaphoreci.com/api/v1alpha/tasks/{task_id}/run_now" \
    -H "Authorization: Token {api_token}" \
    -H "Content-Type: application/json" \
    -d $'{
        "reference": "v1.0.0",  # Can be branch or tag
        "pipeline_file": "/.semaphore/deploy.yml",
        "parameters": {
            "DEPLOY_ENV": "production"
        }
    }'
```

### 2. Service Accounts API Endpoints (NEW)
**File**: `docs/reference/api.md`
**Status**: CRITICAL - Partially implemented

#### Add New Section After Tasks:
```markdown
## Service Accounts

### Create Service Account
POST /api/v1alpha/service-accounts

### List Service Accounts
GET /api/v1alpha/service-accounts

### Get Service Account
GET /api/v1alpha/service-accounts/:id

### Update Service Account
PATCH /api/v1alpha/service-accounts/:id

### Delete Service Account
DELETE /api/v1alpha/service-accounts/:id

### Regenerate Token
POST /api/v1alpha/service-accounts/:id/regenerate-token
```

### 3. Notification Filters API
**File**: `docs/reference/api.md`
**Status**: HIGH - Feature completed

#### Add to existing notification endpoints:
- Document new `tags` filter field
- Document new `ref_type` filter field (values: "branch", "tag")
- Add examples of tag-based notification filters

---

## üì∏ Screenshots That Need Updates

### Tasks UI Screenshots (6 updates needed)
**Directory**: `docs/docs/using-semaphore/img/`
**Priority**: HIGH

#### Screenshots to update:
1. **task-create-2.jpg** - "Branch and pipeline" step
   - **Change needed**: Show "Reference" field instead of "Branch" field
   - **Add**: Dropdown or input showing both branch and tag options
   - **Example text**: Show "v1.0.0" as a tag example

2. **task-run.jpg** - Running task manually dialog
   - **Change needed**: Update to show "Reference" field
   - **Add**: Example with a tag selected

3. **task-view.jpg** - Task details view
   - **Change needed**: Show tasks that have been run with tags
   - **Add**: History showing both branch and tag executions

### Notifications UI Screenshots (3 updates needed)
**Directory**: `docs/docs/using-semaphore/img/`
**Priority**: MEDIUM

#### Screenshots to update:
1. **notifications-setup-2.jpg** - Slack webhook setup
   - **Add**: Show new tag filter options
   - **Add**: ref_type dropdown (if visible in UI)

2. **notifications-setup-3.jpg** - Webhook service setup
   - **Add**: Tag pattern field
   - **Add**: Example showing "v*" or "release-*" patterns

### Organization UI Screenshots (1 update maybe needed)
**Directory**: `docs/docs/using-semaphore/img/`
**Priority**: LOW

#### Screenshot to verify:
1. **add-people-button.jpg** - Add people button
   - **Verify**: Button is visible in EE environments
   - **Note**: May not need update if PR #431 fixed visibility

### New Screenshots Needed

#### Service Accounts (5 new screenshots)
**Directory**: `docs/docs/using-semaphore/img/`
**Priority**: MEDIUM

1. **service-account-list.jpg** - Service accounts list view
2. **service-account-create.jpg** - Create service account dialog
3. **service-account-details.jpg** - Service account details page
4. **service-account-token.jpg** - Token generation/display
5. **service-account-permissions.jpg** - Permissions settings

#### User Profile (2 new screenshots)
**Directory**: `docs/docs/using-semaphore/img/`
**Priority**: LOW (feature not implemented)

1. **user-profile-email.jpg** - Email edit form
2. **user-profile-confirmation.jpg** - Email confirmation dialog

---

## üìù Text Content That Needs Manual Review

### 1. Environment Variables Documentation
**File**: `docs/reference/env-vars.md`
**Check for**: New environment variables related to tags in tasks
- `SEMAPHORE_GIT_REF_TYPE` - Should be documented if added
- `SEMAPHORE_GIT_TAG_NAME` - Should be documented if added

### 2. CLI Documentation
**File**: `docs/reference/semaphore-cli.md`
**Updates needed**:
- Update `sem run task` command with `--reference` flag
- Add service account management commands (if CLI support exists)
- Update notification commands with tag filter examples

### 3. Workflow Examples
**File**: `docs/using-semaphore/workflows.md`
**Add**: Examples showing workflows triggered by tags

---

## ‚úÖ Verification Checklist

Before releasing v1.5 documentation:

### API Documentation
- [ ] Tasks API updated with `reference` parameter
- [ ] Service Accounts API endpoints documented
- [ ] Notification API includes tag filters
- [ ] All examples use new syntax
- [ ] Authentication section mentions service accounts

### Screenshots
- [ ] All task screenshots show "Reference" instead of "Branch"
- [ ] Tag examples visible in task screenshots
- [ ] Notification screenshots show tag filter options
- [ ] Service account screenshots created
- [ ] All screenshots are high quality (min 1200px width)

### Code Examples
- [ ] YAML examples updated with tag support
- [ ] API curl examples use `reference` parameter
- [ ] Notification YAML includes tag filters
- [ ] Parameter examples in conditions (when implemented)

### Cross-references
- [ ] Links between related documentation updated
- [ ] New service accounts page linked from appropriate places
- [ ] API reference linked from feature documentation

---

## üöÄ Quick Wins (Can be done immediately)

1. **Update API documentation** for tasks - just change `branch` to `reference`
2. **Add tag examples** to existing notification documentation
3. **Create placeholder** for service accounts documentation

---

## üìÖ Timeline Recommendations

### Week 1 (Immediate)
- Update all API documentation (HIGH PRIORITY)
- Update task screenshots with reference field
- Add notification tag filter documentation

### Week 2
- Create service account documentation and screenshots
- Update CLI documentation
- Add workflow examples with tags

### Week 3 (Before Release)
- Final review of all documentation
- Verify all links work
- Test all code examples
- Get screenshots reviewed by UX team

---

## Notes for Documentation Team

1. **Backwards Compatibility**: Document that `branch` parameter still works but is deprecated in favor of `reference`

2. **Security Considerations**: Ensure service account documentation includes:
   - Token rotation best practices
   - Access control limitations
   - Audit logging information

3. **Migration Guide**: Consider adding a section on migrating from branch-only to reference-based tasks

4. **Video Updates**: The video tutorial at the top of tasks.md may need updating or a note about new features

5. **Localization**: If documentation is translated, flag these changes for translation team