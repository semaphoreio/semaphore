# Semaphore v1.5 Documentation Update Plan

This document outlines all documentation changes required for the v1.5 release based on completed features and the [v1.5.0-rc.1 changelog](https://github.com/semaphoreio/semaphore/releases/tag/v1.5.0-rc.1).

## Status Legend

- ‚úÖ COMPLETED - Feature implemented and deployed
- üöß IN PROGRESS - Partially implemented
- üìù PLANNED - Not started
- üîÑ NEEDS UPDATE - Documentation exists but needs updates

---

## High Priority Documentation Updates

### 1. Tasks with Tag Support (‚úÖ COMPLETED)

**Status**: Feature completed in [PR #599](https://github.com/semaphoreio/semaphore/pull/599)
**File**: `docs/using-semaphore/tasks.md` üîÑ

#### Required Changes:

- Add new section: "Running Tasks on Git Tags"
- Update existing examples to show `reference` field usage
- Add tag-specific examples:
  ```yaml
  task:
    name: "release-deploy"
    pipeline_file: deploy.yml
    reference: v1.0.0  # Can be branch or tag
  ```
- Update CLI section with tag support: !sem run does not exist!
  ```bash
  sem run task release-deploy --reference v1.0.0
  ```
- Add limitations/notes about tag vs branch behavior

### 2. Webhook Notifications for Tags (‚úÖ COMPLETED)

**Status**: Feature completed in multiple PRs (#591, #586, #585, #596, #601)
**Files**:
- `docs/using-semaphore/notifications.md` üîÑ
- `docs/reference/notifications-yaml.md` üîÑ

#### Required Changes:

##### notifications.md:

- Add section: "Filtering Notifications by Git Tags"
- Provide practical examples for production release notifications
- Document the new `tags` and `ref_type` filters

##### notifications-yaml.md:

- Add new filter properties documentation:
  ```yaml
  filter:
    projects:
      - my-project
    ref_type: tag  # New: filter by reference type
    tags:          # New: filter by tag patterns
      - "v*"
      - "release-*"
  ```
- Update the filter properties table
- Add regex pattern examples for tags

---

## Medium Priority Documentation Updates

### 3. Service Accounts (‚úÖ COMPLETED)

**Status**: Partially implemented with multiple PRs merged
**File**: NEW - `docs/using-semaphore/service-accounts.md` üìù

#### Content Structure:

```markdown
# Service Accounts

## Overview
- What are service accounts
- Use cases (CI/CD automation, API access)
- Differences from user accounts

## Creating Service Accounts
- UI walkthrough
- CLI commands
- Required permissions

## Authentication
- Token generation
- Token rotation
- Security best practices

## API Access
- Using service accounts with Semaphore API
- Example: Triggering pipelines programmatically

## Limitations
- No UI access
- Cannot create projects with certain Git providers
- Email domain restrictions

## Troubleshooting
- Common issues and solutions
```

TOMFERN - continue here

### 4. User Email Editing (‚úÖ COMPLETED) 

**Status**: Not implemented yet
**File**: NEW - `docs/using-semaphore/user-profile.md` üìù

#### Content Structure:

```markdown
# User Profile Management

## Editing Your Email Address
- Navigate to My Profile
- Email validation requirements
- Confirmation process
- Impact on existing permissions

## Security Requirements
- Email uniqueness validation
- Confirmation code verification
- Organization admin approval (CE/EE)
```

---

## Low Priority Documentation Updates

### 5. Parameters in DSL Conditions (‚úÖ COMPLETED)

**Status**: Not implemented yet
**File**: `docs/reference/conditions-dsl.md` üîÑ

#### Required Changes:

- Add new section: "Using Parameters in Conditions"
- Document parameter syntax: `${{parameters.NAME}}`
- Provide examples:
  ```yaml
  run:
    when: "'${{parameters.ENV}}' = 'prod' AND branch = 'master'"

  auto_promote:
    when: "'${{parameters.DEPLOY}}' = 'true'"
  ```
- Add security considerations for parameter injection

### 6. Bug Fixes Documentation

#### Add People Button in EE (‚úÖ FIXED)

does not need direct documentation update
**File**: `docs/using-semaphore/organizations.md` üîÑ
- Add troubleshooting note about EE visibility
- Document the environment detection logic

#### Skip Onboarding for Existing Configs (‚úÖ COMPLETED)

**File**: `docs/using-semaphore/projects.md` üîÑ
- Add section on "Connecting Projects with Existing Configuration"
- Document the skip onboarding button
- Explain preservation of existing `.semaphore` files

---

## Additional Documentation Needs

### API Reference Updates

**File**: `docs/reference/api.md` üîÑ

#### Changes:

- Update Tasks API section with tag support
- Add Service Accounts API endpoints
- Document user profile management endpoints
- Add examples for new functionality

### CLI Reference Updates

**File**: `docs/reference/semaphore-cli.md` üîÑ

#### Changes:

- Update `sem run task` with `--reference` flag
- Add service account management commands
- Update notification commands with tag filters

### Release Notes

**File**: NEW - `docs/release-notes/v1.5.0.md` üìù

#### Content:

- Complete feature list from changelog
- Migration guide from v1.4.x
- Breaking changes (if any)
- Known issues and workarounds

---

## Implementation Timeline

### Phase 1: Document Completed Features (Immediate)

1. Tasks with tag support
2. Webhook notifications for tags
3. Bug fix documentation

### Phase 2: Document In-Progress Features (Before v1.5 release)

1. Service Accounts documentation
2. API reference updates
3. CLI reference updates

### Phase 3: Document Planned Features (As implemented)

1. User email editing
2. Parameters in DSL conditions
3. Complete release notes

---

## Review Checklist

Before v1.5 release, ensure:
- [ ] All completed features have documentation
- [ ] API reference is updated
- [ ] CLI reference is updated
- [ ] Examples are tested and working
- [ ] Security considerations are documented
- [ ] Migration guide is complete
- [ ] Release notes are finalized

---

## Notes

- Priority based on feature completion status
- Documentation should include both UI and CLI approaches
- Security requirements must be clearly documented
- Include troubleshooting sections for complex features
- All examples should be tested against v1.5.0-rc.1
